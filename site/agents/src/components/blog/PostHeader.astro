---
import type { CollectionEntry } from 'astro:content';

interface Props {
  title: string;
  pubDate: Date;
  author: string | string[];
  authorData?: (CollectionEntry<'authors'> | undefined)[];
  tags?: string[];
}

const { title, pubDate, author, authorData, tags } = Astro.props;

const formattedDate = new Intl.DateTimeFormat('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
}).format(pubDate);

const authors = Array.isArray(author) ? author : [author];
const authorDisplay = authors.length === 1 
  ? authors[0] 
  : authors.length === 2 
    ? `${authors[0]} and ${authors[1]}`
    : `${authors.slice(0, -1).join(', ')}, and ${authors[authors.length - 1]}`;

// Get first author's avatar if available
const firstAuthorData = authorData && authorData.length > 0 ? authorData[0] : undefined;
---

<header class="p-6 border-b border-orange-400">
  <h1 class="text-4xl lg:text-5xl font-semibold mb-4">{title}</h1>
  <div class="flex items-center gap-4 text-sm text-orange-500 flex-wrap">
    <time datetime={pubDate.toISOString()}>{formattedDate}</time>
    <span>•</span>
    <div class="flex items-center gap-2">
      {firstAuthorData && (
        <img
          src={firstAuthorData.data.avatar}
          alt={`${firstAuthorData.data.name} avatar`}
          class="w-8 h-8 rounded-full object-cover border border-orange-400"
          loading="lazy"
        />
      )}
      <span>{authorDisplay}</span>
    </div>
    {tags && tags.length > 0 && (
      <>
        <span>•</span>
        <div class="flex gap-2 flex-wrap">
          {tags.map((tag) => (
            <span class="px-2 py-1 bg-orange-100 text-orange-700 rounded text-xs">
              {tag}
            </span>
          ))}
        </div>
      </>
    )}
  </div>
</header>

